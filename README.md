# 智能专业匹配与校验工具

## 目录

- [项目简介](#项目简介)
- [主要功能](#主要功能)
- [如何使用](#如何使用)
- [核心逻辑](#核心逻辑)
  - [数据匹配规则](#数据匹配规则)
  - [数据校验规则](#数据校验规则)
- [技术栈](#技术栈)
- [界面概览](#界面概览)

## 项目简介

本项目是一个纯前端的单页面应用，旨在帮助教育机构或相关从业者高效处理和整合专业数据。通过上传一个现有的专业数据库Excel文件和一个包含新专业信息的Excel文件，本工具能够自动完成以下任务：

1.  **智能匹配**：将新数据与现有数据库进行多层级、多字段的智能匹配。
2.  **格式校验与修正**：对新数据中的关键字段（如学制、开学时间、申请费用）进行格式校验，并自动修正不规范的条目。
3.  **结果呈现**：以清晰的统计面板和高亮表格形式展示匹配和校验结果，并支持结果数据的下载。

该工具完全在浏览器端运行，无需后端服务，保证了数据的私密性和安全性。

## 主要功能

- **双Excel文件上传**：支持同时上传“现有数据库”和“新数据”两个文件。
- **自动化匹配与校验**：一键启动，自动执行全部匹配和校验流程。
- **可视化统计面板**：
  - **总览**: 显示总记录数。
  - **匹配统计**: 清晰展示“匹配成功”、“新增专业”、“待定专业”的数量。
  - **格式校验统计**: 统计“学制问题”、“开学时间问题”、“申请费用问题”的数量。
- **交互式结果表格**：
  - **高亮显示**：不同匹配状态的行会以不同颜色高亮，一目了然。
  - **关键列冻结**：`专业ID`、`匹配结果`、`格式校验问题`三列在水平滚动时保持固定，方便对比。
  - **滚动区域**：表格内容在固定高度的容器内滚动，保持页面布局整洁。
- **信息说明面板**：在页面顶部提供可折叠的详细说明，解释工具的功能、匹配规则和校验规则，帮助用户快速上手。
- **结果下载**：允许用户将处理完成的数据（包含匹配和校验结果）下载为新的Excel文件。

## 如何使用

1.  **准备文件**：准备两个Excel文件：
    -   `现有数据库.xlsx`：包含基准专业数据的表格。
    -   `新数据.xlsx`：需要进行匹配和校验的新增专业数据。
2.  **打开工具**：在现代浏览器（如Chrome, Firefox, Edge）中直接打开 `专业数据匹配校验工具.html` 文件。
3.  **上传文件**：点击对应的“选择文件”按钮，分别上传两个Excel文件。
4.  **执行处理**：点击“开始匹配和校验”按钮。
5.  **查看结果**：
    -   在页面上方的统计面板查看宏观统计数据。
    -   在下方的表格中逐条查看详细的匹配和校验结果。
6.  **下载结果**：点击“下载处理结果”按钮，保存处理后的数据为Excel文件。

## 核心逻辑

为了确保匹配的准确性和数据的规范性，工具内置了清晰的匹配与校验规则。

### 数据匹配规则

匹配过程遵循以下四级优先级，从上至下依次进行：

1.  **第一级：通过 `专业ID` 精确匹配**
    -   **描述**：最优先、最可靠的匹配方式。
    -   **状态**：`通过专业ID匹配`

2.  **第二级：通过 `专业链接` 精确匹配**
    -   **描述**：当专业ID无法匹配时，使用唯一的专业页面链接进行匹配。
    -   **状态**：`通过专业链接匹配`

3.  **第三级：通过 `专业中文名` 和 `学位等级` 精确匹配**
    -   **描述**：作为备选方案，要求专业名称和学位等级完全一致。
    -   **状态**：`通过专业中文名和学位等级匹配`

4.  **第四级：通过 `专业英文名` 和 `学位名称` 模糊匹配**
    -   **描述**：最后的尝试，使用英文名和学位名进行模糊搜索，以应对可能的轻微拼写差异。
    -   **状态**：`通过专业英文名模糊匹配`

- **新增专业**：如果一条新数据经过以上四级规则都无法在现有数据库中找到匹配项，则被标记为 `新增专业`。
- **待定专业**：如果匹配过程中出现一对多等不确定情况，则被标记为 `待定专业`，需要人工审核。

### 数据校验规则

工具会对新数据中的特定列进行格式检查和自动修正：

1.  **学制 (`Duration`)**
    -   **标准格式**：数字 + "年" (例如: `2年`)
    -   **修正逻辑**：能自动将纯数字（如 `2`）或包含其他单位的文本（如 `2 years`）修正为标准格式。

2.  **开学时间 (`Start Time`)**
    -   **标准格式**：`X月` (例如: `7月` or `2月, 7月`)
    -   **修正逻辑**：能够识别并转换多种日期格式（如 `July`、`2月/7月`、`Feb`）为标准格式。

3.  **申请费用 (`Application Fee`)**
    -   **标准格式**：数字 + 币种中文全称 (例如: `150澳大利亚元`)
    -   **修正逻辑**：内置详尽的币种映射表，可识别常见的币种符号、缩写、中英文名称（如 `AUD`, `澳元`, `A$`, `aud`），并将其转换为统一的中文全称。

## 技术栈

- **HTML5**: 页面结构
- **CSS3**: 页面样式与布局
- **JavaScript (ES6+)**: 核心业务逻辑
- **SheetJS (xlsx.js)**: 用于在浏览器端读取和写入Excel文件。

## 界面概览

工具界面主要分为四个部分：

1.  **信息面板**：位于页面顶部，包含“功能概述”、“匹配规则”、“校验规则”三个可折叠的卡片，为用户提供清晰指引。
2.  **操作区域**：包含文件上传控件和功能触发按钮。
3.  **统计面板**：以卡片形式直管展示匹配和校验的各项统计数据。
4.  **结果表格**：展示详细处理结果，支持滚动和关键列冻结。 